![Google Drive](https://img.shields.io/badge/Google%20Drive-4285F4?style=for-the-badge&logo=googledrive&logoColor=white)![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)![NumPy](https://img.shields.io/badge/numpy-%23013243.svg?style=for-the-badge&logo=numpy&logoColor=white)![PyTorch](https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?style=for-the-badge&logo=PyTorch&logoColor=white)![HuggingFace](https://img.shields.io/badge/huggingface-%23FFD21E.svg?style=for-the-badge&logo=huggingface&logoColor=white)![Google Colab](https://img.shields.io/badge/Google%20Colab-%23F9A825.svg?style=for-the-badge&logo=googlecolab&logoColor=white)![Stable Diffusion](https://img.shields.io/badge/Stable%20Diffusion-blue?style=for-the-badge)![LoRA](https://img.shields.io/badge/LoRA-green?style=for-the-badge)

# LoRA SD Generator

**LoRA-SD-Generator**  ‚Äî —ç—Ç–æ –ª–∏—á–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç –ø–æ —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ (**fine-tuning**) –º–æ–¥–µ–ª–∏  **Stable Diffusion 1.5**  —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞  **LoRA**  (**Low-Rank Adaptation**) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü –ø–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –æ–ø–∏—Å–∞–Ω–∏—è–º.

_–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞_  ‚Äî —Å–æ–∑–¥–∞—Ç—å –ª—ë–≥–∫—É—é, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—É—é –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—É—é –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è —Å–ø–æ—Å–æ–±–Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ç—Ä–µ—Ç—ã, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –Ω–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤.

## –ù–µ–º–Ω–æ–≥–æ —Ç–µ–æ—Ä–∏–∏

–ß—Ç–æ–±—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–Ω—è—Ç—å –ø—Ä–æ–µ–∫—Ç, —Ä–∞–∑–±–µ—Ä–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:

- **Stable Diffusion (SD)**: –õ–∞—Ç–µ–Ω—Ç–Ω–∞—è –¥–∏—Ñ—Ñ—É–∑–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –æ—Ç **Stability AI**, –æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ –º–∏–ª–ª–∏–∞—Ä–¥–∞—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (**LAION-5B**). –û–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ (—Å–∂–∞—Ç–æ–º —Å –ø–æ–º–æ—â—å—é **VAE**), –≥–¥–µ —à—É–º –ø–æ—ç—Ç–∞–ø–Ω–æ —É–¥–∞–ª—è–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. 

- **LoRA (Low-Rank Adaptation)**: –ú–µ—Ç–æ–¥ **PEFT** –æ—Ç **Microsoft**, –∞–¥–∞–ø—Ç–∏—Ä—É—é—â–∏–π –±–æ–ª—å—à–∏–µ –º–æ–¥–µ–ª–∏ (–∫–∞–∫ **SD**) –ø—É—Ç–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∏–∑–∫–æ—Ä–∞–Ω–≥–æ–≤—ã—Ö –º–∞—Ç—Ä–∏—Ü –∫ –≤–µ—Å–∞–º. –í–º–µ—Å—Ç–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –≤—Å–µ—Ö ~860M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ **SD**, **LoRA** –æ–±—É—á–∞–µ—Ç –ª–∏—à—å ~1-10M (`rank=16` –≤ –ø—Ä–æ–µ–∫—Ç–µ). –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç **VRAM** –¥–æ 4-6GB –∏ —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ. 

- **DreamBooth**: —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –∏ –º–æ—â–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–æ–æ–±—É—á–∏—Ç—å **Stable Diffusion**, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –Ω–∞—É—á–∏–ª–∞—Å—å —Ö–æ—Ä–æ—à–æ —Ä–∏—Å–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞, –∂–∏–≤–æ—Ç–Ω–æ–µ, –ø—Ä–µ–¥–º–µ—Ç –∏–ª–∏ —Å—Ç–∏–ª—å –ø–æ 3‚Äì5 –≤–∞—à–∏–º —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º.

- **BLIP (Bootstrapped Language-Image Pre-training)**: –ú–æ–¥–µ–ª—å –æ—Ç **Salesforce** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ caption –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º. –í –ø—Ä–æ–µ–∫—Ç–µ **BLIP** (`Salesforce/blip-image-captioning-base`) —Å–æ–∑–¥–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –¥–∞—Ç–∞—Å–µ—Ç–∞ CelebA.


## –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

> –ó–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–¥ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º —É—Å–∫–æ—Ä–∏—Ç–µ–ª–µ–º! –í –º–æ–µ–º –ø—Ä–∏–º–µ—Ä–µ
> –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **T4**.

 - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö: –∑–∞–≥—Ä—É–∑–∫–∞, –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ (resize 512x512) –∏ captioning —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **BLIP**;
 - –û–±—É—á–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∫—Ä–∏–ø—Ç–∞ `train_dreambooth_lora.py` –∏–∑ **Hugging Face Diffusers**;
 - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å **Google Drive** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞, –º–æ–¥–µ–ª–µ–π –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π;
 - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–¥ **T4 GPU**: mixed precision (fp16), gradient accumulation.
 
 **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–æ–¥–µ–ª—å **LoRA** (`pytorch_lora_weights.safetensors`), —Å–ø–æ—Å–æ–±–Ω–∞—è –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–∏—Ü–∞ –ø–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø—Ä–æ–º–ø—Ç–∞–º.

> –¢–∞–∫–∂–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–¥–æ–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è **HuggingFace** —Ç–æ–∫–µ–Ω –∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å
> –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–µ–º—É **Google Drive**. –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ—ç—Ç–∞–ø–Ω–æ
> –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ —Å–∞–º–æ–π —Ä–∞–±–æ—Ç–µ!


## üì∏ –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞

### –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ù–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö –Ω–∏–∂–µ –ø–æ–∫–∞–∑–∞–Ω –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–æ–º–ø—Ç–∞ –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

<p align="center">
  <img 
    width="1280" 
    height="433" 
    src="https://github.com/user-attachments/assets/730407ac-ec75-4f20-9db2-e6f8f0fc1738"
  >
  <br>
</p>

---

<p align="center">
  <img 
    width="1280" 
    height="407" 
    src="https://github.com/user-attachments/assets/03d57d8d-1cc3-495d-8404-922b7101c4a3"
  >
  <br>
</p>

